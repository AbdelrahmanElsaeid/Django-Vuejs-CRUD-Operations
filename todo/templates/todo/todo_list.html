<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
  <title>Bootstrap Modal Example</title>
  <script src="https://cdn.jsdelivr.net/npm/vue@3.2.6/dist/vue.global.prod.js"></script>
</head>
<body>



<div class="text-center mt-5">
  <h1> To Do </h1>
</div>

<div class="container mt-5 " id="starting"> 
  <div class="row">
    <div style="display: flex;" >
      <button type="button" class="btn btn-primary" style="width: 930px; margin-left: 100px;" data-toggle="modal" data-target="#newModal">New Modal</button>
    </div>
  </div>
  <div class="row">                          
        <div class="col-lg-10 mx-auto">
            <table class="table">
                <thead>
                  <tr>
                    <th scope="col">#</th>
                    <th scope="col">Task</th>
                    <th scope="col">Notes</th>
                    <th scope="col">Done</th>
                    <th scope="col">Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr v-for="item in todo_list"> 
                    <th scope="row">#</th>
                    <td>${item.title}</td>
                    <td>${item.notes}</td>
                    <td>${item.done}</td>                  
                    <td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#editModal">Edit</button>
                    <button type="button" class="btn btn-danger" v-on:click="todoDelete(item.id)" >Delete</button></td>
 
                  </tr>
                  
                </tbody>
              </table>
        </div>

        <div class="modal fade" id="newModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">New Data</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <form v-on:submit.prevent="addToDo()">
                  <div class="mb-3">
                    <label for="exampleFormControlInput1" class="form-label">Task</label>
                    <input type="text" class="form-control" id="example" v-model="new_todo.title">
                  </div>
                  
                  <div class="mb-3">
                    <label for="exampleFormControlInput1" class="form-label">Notes</label>
                    <input type="text" class="form-control" id="exampleF" v-model="new_todo.notes">
                  </div>
                  <div class="mb-3">
                    <label for="exampleFormControlInput1" class="form-label">Done</label>
                    <input type="text" class="form-control" id="exampleF" v-model="new_todo.done">
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <input type="submit" class="btn btn-primary" value="Save changes">
                    </div>
                </form>
              </div>
             
            </div>
          </div>
        </div>


        <div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Edit Data</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <form v-on:submit.prevent="todoUpdate()">
                  <div class="mb-3">
                    <label for="exampleFormControlInput1" class="form-label">Task</label>
                    <input type="text" class="form-control" id="example" v-model="current_todo.title">
                  </div>
                  
                  <div class="mb-3">
                    <label for="exampleFormControlInput1" class="form-label">Notes</label>
                    <input type="text" class="form-control" id="exampleF" v-model="current_todo.notes">
                  </div>
                  <div class="mb-3">
                    <label for="exampleFormControlInput1" class="form-label">Done</label>
                    <input type="text" class="form-control" id="exampleF" v-model="current_todo.done">
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <input type="submit" class="btn btn-primary" value="Save changes">
                    </div>
                </form>
              </div>
             
            </div>
          </div>
        </div>

              
          
    </div>
</div>  

<!--**************************Bootstrap**********************-->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
<!--**************************Bootstrap**********************-->
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.1.3/axios.min.js" integrity="sha512-0qU9M9jfqPw6FKkPafM3gy2CBAvUWnYVOfNPDYKVuRTel1PrciTj+a9P3loJB+j0QmN2Y0JYQmkBBS8W+mbezg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@3.0.11/dist/vue.global.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.1.3/axios.min.js" integrity="sha512-0qU9M9jfqPw6FKkPafM3gy2CBAvUWnYVOfNPDYKVuRTel1PrciTj+a9P3loJB+j0QmN2Y0JYQmkBBS8W+mbezg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<!--
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.4.0/axios.min.js" integrity="sha512-uMtXmF28A2Ab/JJO2t/vYhlaa/3ahUOgj1Zf27M5rOo8/+fcTUVH0/E0ll68njmjrLqOBjXM3V9NiPFL5ywWPQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>

-->


<script type="text/javascript">
   axios.defaults.xsrfCookieName = 'csrftoken'
   axios.defaults.xsrfHeaderName = "X-CSRFTOKEN"


  var app = new Vue ({
    el: '#starting',
    delimiters: ['${','}'],
    data:{
      todo_list: [],
      new_todo: {
        'title': null,
        'notes': null,
        'done': null,
      },
      current_todo:{}
    },
    mounted:function(){
      //run : when loading
      this.getTodo();

    },
    methods:{
      getTodo:function(){
        axios.get('/todo/api/todo/')
        .then((response) => {
          this.todo_list = response.data
          console.log(response)
        }

  )},

  getToDO:function(id){
                axios.get(`/todo/api/todo/${id}/`)
                .then((response)=>{
                  this.current_todo = response.data;
                })
              },

  addToDo:function(){
    axios.post('/todo/api/todo/', this.new_todo)
    .then((response)=>{
      this.getTodo();
    })

  },

  todoUpdate:function(){
    axios.put(`/todo/api/todo/${this.curent_todo.id}/`,this.current_todo)
    .then((response)=>{
      this.current_todo = response.data;
      this.getTodo();
    })
  },

  todoDelete:function(id){
    axios.delete(`/todo/api/todo/${id}/`)
    .then((response)=>{
      this.getTodo();
    })

  },

 



    }

  })
</script>

  </body>
</html>